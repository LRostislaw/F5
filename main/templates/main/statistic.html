{% load static %}

{% if request.user_agent.is_mobile %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Статистика</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/style_mobile.min.css' %}">
    <link rel="stylesheet" href="http://cdn.jsdelivr.net/chartist.js/latest/chartist.min.css">
</head>
<body>
    <table>
        <tr>
            <td width="114px" valign="top">
                <nav>
                    <ul class="menu">
                        <li><button onclick="window.location.href = 'home';" class="menu_item"><div class="menu_logo">F5</div> <div class="menu_link">главная</div></button></li>
                        <li><button {% if request.user.is_authenticated %}onclick="window.location.href = 'statistic'";{% else %}onclick="window.location.href = 'login'";{% endif %} class="menu_item_active"><div class="menu_icon"><img src="{% static 'icons/icon_statistics.svg' %}"></div><div class="menu_link">статисика</div></button></li>
                        <li><button {% if request.user.is_authenticated %}onclick="window.location.href = 'settings'";{% else %}onclick="window.location.href = 'login'";{% endif %}  class="menu_item"><div class="menu_icon"><img src="{% static 'icons/icon_settings.svg' %}"></div><div class="menu_link">настройки</div></button></li>
                    </ul>
                </nav>
            </td>
            {% if request.user.is_authenticated %}
            <td width="33%" valign="top">

                <div class="add"><button class="plus">+</button></div>
                <ul class="types">
                    <li><button class="type" type="button" data-toggle="collapse" data-target="#Info" aria-expanded="true" aria-controls="Info">Артериальное давление</button></li>
                </ul>
            </td>
            <td width="67%" valign="top">
                {{ statistics.systolic_ad }}
                <div class="collapse show" id="Info">
                    <div class="block_page card card-body">
                        <div class="add"><button class="plus" type="button" data-toggle="collapse" data-target="#FormAd" aria-expanded="false" aria-controls="FormAd">+</button></div>
                        <div class="save collapse multi-collapse" id="FormAd">
                            <div class="card card-body">
                                <form method="POST">
                                    {% csrf_token %}
                                    {{ form.systolic_ad }}
                                    {{ form.diastolic_ad }}
                                    {{ form.time }}
                                    <button type="submit" class="save_btn">Сохранить</button>
                                </form>
                            </div>
                        </div>
                        <div class="accordion" id="accordionStatistics">
                            <div class="card">
                                <div class="card-header" id="headingOne">
                                    <button class="btn btn-link btn-block" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                      За 10 дней
                                    </button>
                                </div>
                                <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordionStatistics">
                                    <div class="card-body">
                                        <div class="line-graph"></div>

                                    </div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-header" id="headingTwo">
                                    <button class="btn btn-link btn-block collapsed" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                      За 10 дней
                                    </button>
                                </div>
                                <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionStatistics">
                                    <div class="card-body">
                                        <div class="bar-graph"></div>
                                    </div>
                                </div>
                            </div>

                            <div class="card">
                                <div class="card-header" id="headingThree">
                                    <button class="btn btn-link btn-block collapsed" type="button" data-toggle="collapse" data-target="#collapseThree" aria-expanded="true" aria-controls="collapseThree">
                                      За 10 дней
                                    </button>
                                </div>
                                <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordionStatistics">
                                    <div class="card-body">
                                        <div class="donut-graph"></div>
                                        g
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </td>
            {% else %}
            <td width="100%" valign="center">
                <button class="auth_btn"><a href="login">Вход</a>/<a href="signup">Регистрация</a></button>
            </td>
            {% endif %}
        </tr>
    </table>

    <script src="http://cdn.jsdelivr.net/chartist.js/latest/chartist.min.js"></script>
    {% if statistics %}
    <script>
    var chart = new Chartist.Line('.line-graph', {
    labels: [{% for i in statistics %} '{{ i.time|date:"j" }}', {% endfor %}],
    series: [
      [{% for i in statistics %} {{ i.systolic_ad }}, {% endfor %}],
      [{% for i in statistics %} {{ i.diastolic_ad }}, {% endfor %}],
    ]
    }, {
      showPoint: true,
      width: 300,
      height: 175
    });
    chart.update()
    </script>
    <script>
    var data = {
      labels: [{% for i in statistics %} '{{ i.time|date:"j" }}', {% endfor %}],
      series: [
      [{% for i in statistics %} {{ i.systolic_ad }}, {% endfor %}],
      [{% for i in statistics %} {{ i.diastolic_ad }}, {% endfor %}],
      ]
    };
    var options = {
      width: 300,
      height: 175
    };
    Chartist.Bar('.bar-graph', data, options);
    </script>
    <script>
    var data = {
      series: [5, 3, 4]
    };

    var sum = function(a, b) { return a + b };

    new Chartist.Pie('.donut-graph', data, {
      width: 300,
      height: 150
    });
    </script>
    {% endif %}
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
</body>
</html>
{% else %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Статистика</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/style.min.css' %}">
</head>
<body>

<header>
    <nav>
        <div class="container">
            <div class="row">
                <ul class="menu col-md-10">
                        <li class="menu_item"><a href="home" class="menu_link">Главная</a></li>
                        <li class="menu_item_active">{% if request.user.is_authenticated %}<a href="statistic" class="menu_link">Статистика</a></li>{% else %}<a href="login" class="menu_link">Статистика</a>{% endif %}
                        <li class="menu_item">{% if request.user.is_authenticated %}<a href="settings" class="menu_link">Настройки</a></li>{% else %}<a href="login" class="menu_link">Настройки</a></li>{% endif %}
                    </ul>
            {% if request.user.is_authenticated %}
            {% else %}
                <button class="auth_btn col-md-2"><a href="login">Вход</a>/<a href="signup">Регистрация</a></button>
            {% endif %}
          </div>
        </div>
    </nav>
</header>

    <section class="main">
    </section>

    <footer>
        <div class="info">
            <div class="info_links">
                <a href="#" class="underlined">Служба поддержки</a>
                |
                <a href="#" class="underlined">Политика конфиденциальности</a>
            </div>
            Позвоните нам <a href="tel:+88005550121">8-800-555-01-21</a>
        </div>
    </footer>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
</body>
</html>
{% endif %}

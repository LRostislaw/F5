{% load static %}
{% if request.user.is_authenticated %}
    {% if request.user_agent.is_mobile %}
    <!DOCTYPE html>
    <html lang="ru">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Статистика</title>
        <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;900&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
        <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
        <link rel="stylesheet" href="{% static 'css/style_mobile.min.css' %}">
        <link rel="stylesheet" href="http://cdn.jsdelivr.net/chartist.js/latest/chartist.min.css">
    </head>
    <body>
        <table>
            <tr>
                <td width="114px" valign="top">
                    <nav>
                        <ul class="menu">
                            <li><button onclick="window.location.href = 'home';" class="menu_item"><div class="menu_logo">F5</div> <div class="menu_link">главная</div></button></li>
                            <li><button onclick="window.location.href = 'statistic'"; class="menu_item_active"><div class="menu_icon"><img src="{% static 'icons/icon_statistics.svg' %}"></div><div class="menu_link">статисика</div></button></li>
                            <li><button onclick="window.location.href = 'settings'"; class="menu_item"><div class="menu_icon"><img src="{% static 'icons/icon_settings.svg' %}"></div><div class="menu_link">настройки</div></button></li>
                        </ul>
                    </nav>
                </td>
                <td width="33%" valign="top">

                    <div class="add"><button class="plus">+</button></div>
                    <ul class="types">
                        <li><button class="type" type="button" data-toggle="collapse" data-target="#Info" aria-expanded="true" aria-controls="Info">Артериальное давление</button></li>
                    </ul>
                </td>
                <td width="67%" valign="top">
                    {{ statistics.systolic_ad }}
                    <div class="collapse show" id="Info">
                        <div class="block_page card card-body">
                            <div class="add"><button class="plus" type="button" data-toggle="collapse" data-target="#FormAd" aria-expanded="false" aria-controls="FormAd">+</button></div>
                            <div class="save collapse multi-collapse" id="FormAd">
                                <div class="card card-body">
                                    <form method="POST">
                                        {% csrf_token %}
                                        {{ form.systolic_ad }}
                                        {{ form.diastolic_ad }}
                                        {{ form.time }}
                                        <button type="submit" class="save_btn">Сохранить</button>
                                    </form>
                                </div>
                            </div>
                            <div class="accordion" id="accordionStatistics">
                                <div class="card">
                                    <div class="card-header" id="headingOne">
                                        <button class="btn btn-link btn-block" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                          За 10 дней
                                        </button>
                                    </div>
                                    <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordionStatistics">
                                        <div class="card-body">
                                            <div class="line-graph"></div>

                                        </div>
                                    </div>
                                </div>
                                <div class="card">
                                    <div class="card-header" id="headingTwo">
                                        <button class="btn btn-link btn-block collapsed" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                          За месяц
                                        </button>
                                    </div>
                                    <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionStatistics">
                                        <div class="card-body">
                                            <div class="bar-graph"></div>
                                        </div>
                                    </div>
                                </div>

                                <div class="card">
                                    <div class="card-header" id="headingThree">
                                        <button class="btn btn-link btn-block collapsed" type="button" data-toggle="collapse" data-target="#collapseThree" aria-expanded="true" aria-controls="collapseThree">
                                          За всё время
                                        </button>
                                    </div>
                                    <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordionStatistics">
                                        <div class="card-body">
                                            <div class="donut-graph"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </table>

        <script src="http://cdn.jsdelivr.net/chartist.js/latest/chartist.min.js"></script>
        {% if statistics %}
        <script>
        var chart = new Chartist.Line('.line-graph', {
        labels: [{% for i in statistics %} '{{ i.time|date:"j" }}', {% endfor %}],
        series: [
          [{% for i in statistics %} {{ i.systolic_ad }}, {% endfor %}],
          [{% for i in statistics %} {{ i.diastolic_ad }}, {% endfor %}],
        ]
        }, {
          showPoint: true,
          width: 300,
          height: 175
        });
        chart.update()
        </script>
        <script>
        var data = {
          labels: [{% for i in statistics %} '{{ i.time|date:"j" }}', {% endfor %}],
          series: [
          [{% for i in statistics %} {{ i.systolic_ad }}, {% endfor %}],
          [{% for i in statistics %} {{ i.diastolic_ad }}, {% endfor %}],
          ]
        };
        var options = {
          width: 300,
          height: 175
        };
        Chartist.Bar('.bar-graph', data, options);
        </script>
        <script>
        var data = {
          series: [5, 3, 4]
        };

        var sum = function(a, b) { return a + b };

        new Chartist.Pie('.donut-graph', data, {
          width: 300,
          height: 150
        });
        </script>
        {% endif %}
        <script src="{% static 'js/bootstrap.min.js' %}"></script>
    </body>
    </html>
    {% else %}
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Статистика</title>
            <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;900&display=swap" rel="stylesheet">
            <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
            <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
            <link rel="stylesheet" href="{% static 'css/style.min.css' %}">
        </head>
        <body>

            <header>
                <nav>
                    <div class="container">
                        <div class="row">
                            <ul class="menu col-md-12">
                                <li class="menu_item"><a href="home" class="menu_link">Главная</a></li>
                                <li class="menu_item_active"><a href="statistic" class="menu_link">Статистика</a></li>
                                <li class="menu_item"><a href="settings" class="menu_link">Настройки</a></li>
                            </ul>
                      </div>
                    </div>
                </nav>
            </header>

            <section class="main">
            </section>

            <footer>
                <div class="info">
                    <div class="info_links">
                        <a href="#" class="underlined">Служба поддержки</a>
                        |
                        <a href="#" class="underlined">Политика конфиденциальности</a>
                    </div>
                    Позвоните нам <a href="tel:+88005550121">8-800-555-01-21</a>
                </div>
            </footer>
            <script src="{% static 'js/bootstrap.min.js' %}"></script>
        </body>
        </html>
    {% endif %}
{% else %}
    {% if request.user_agent.is_mobile %}
        <!DOCTYPE html>
        <html lang="ru">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1">
            <title>Авторизация</title>
            <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;900&display=swap" rel="stylesheet">
            <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
            <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
            <link rel="stylesheet" href="{% static 'css/style_mobile.min.css' %}">
        </head>
        <body>
            <table>
                <tr>
                    <td>
                        <form method="POST">
                            {% csrf_token %}
                            <div class="auth">
                                <label class="form-label form_label">логин</label>
                                {{ form.username }}
                            </div>
                            <div class="auth">
                                <label class="form-label form_label">пароль</label>
                                {{ form.password }}
                            </div>
                            <button class="auth_btn" type="submit">Вход</button>
                        </form>
                        <a href="signup" class="link_reg">Регистрация</a>
                    </td>
                </tr>
            </table>
            <script src="{% static 'js/bootstrap.min.js' %}"></script>
        </body>
        </html>
    {% else %}
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Авторизация</title>
            <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;900&display=swap" rel="stylesheet">
            <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
            <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
            <link rel="stylesheet" href="{% static 'css/style.min.css' %}">
        </head>
        <body>
            <section class="auth">
                <div class="container">
                    <div class="auth_block">
                        <h2 class="auth_title">Вход</h2>
                        <form method="post">
                            {% csrf_token %}

                            <div class="row">
                                <label for="" class="form-label col-md-3 auth_form_label">логин</label>
                                <div class="col-md-9">{{ form.username }}</div>
                            </div>
                            <div class="row">
                                <label for="" class="form-label col-md-3 auth_form_label">пароль</label>
                                <div class="col-md-9">{{ form.password }}</div>
                            </div>
                            <div class="row">
                                <div class="form-check">
                                    <label class="form-check-label col-md-11 auth_checklabel" for="">Со всем согласен</label>
                                    <input class="form-check-input col-md-1 auth_checkbox" type="checkbox" value="" id="" aria-describedby="invalidCheck3Feedback" required>
                                </div>
                            </div>
                            <button class="auth_btn" type="submit">Войти</button>
                        </form>
                    </div>
                    <a href="signup" class="link_reg">Регистрация</a>
                </div>
            </section>
            <footer>
                <div class="info">
                    <div class="info_links">
                        <a href="#" class="underlined">Служба поддержки</a>
                        |
                        <a href="#" class="underlined">Политика конфиденциальности</a>
                    </div>
                    Позвоните нам <a href="tel:+88005550121">8-800-555-01-21</a>
                </div>
            </footer>
            <script src="{% static 'js/bootstrap.min.js' %}"></script>
        </body>
        </html>
    {% endif %}
{% endif %}
